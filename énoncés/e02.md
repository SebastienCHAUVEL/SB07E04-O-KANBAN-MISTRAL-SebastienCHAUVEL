# 🛠️ Challenge E02 – Route utilisateur connecté & gestion des rôles

## Objectifs

- Ajouter une route GET `/auth/me` permettant de récupérer les informations de l'utilisateur actuellement connecté.
- Mettre en place un système de rôles (admin, utilisateur...) en base de données.
- Associer un rôle à chaque utilisateur.

## 1. Route `/auth/me`

Crée une route GET `/auth/me` qui renvoie les informations de l'utilisateur actuellement connecté.

Quelques éléments à considérer :

- Cette route ne doit être accessible que si l'utilisateur est authentifié.
- Le token JWT contient les informations nécessaires pour identifier l'utilisateur. Ces informations doivent être accessibles dans la route.
- Les informations doivent être extraites depuis la base de données pour éviter de renvoyer directement ce qu’il y a dans le token.

Tu devras probablement intervenir dans les fichiers suivants :

- Un middleware d'authentification déjà en place (où ?)
- Un controller
- Le fichier de routes

**Tests attendus** :

- un appel à `/auth/me` avec un token valide retourne un objet représentant l’utilisateur (par exemple : `id`, `username`).
- dans le frontend, on devrait voir apparaître le nom de l'utilisateur dans la navbar

## 2. Début de mise en place d’un système de rôles

Ajoute une entité `Role` permettant de distinguer les types d’utilisateurs.

Tâches à effectuer :

- Créer un modèle Sequelize pour `Role`
- Relier `User` à `Role` via une relation `belongsTo`
- Mettre à jour la base de données
- Ajouter quelques rôles de base (`user`, `admin`) dans le fichier de seeding
- Lors de l'inscription d’un nouvel utilisateur, il doit avoir automatiquement le rôle `user`
- Inclure le rôle dans la réponse de la route `/auth/me`

- Tu devras avoir deux rôles ajoutés à la base de données (utilise le seeding 💪) :

```js
{
    id: 1,
    name: "admin",
},
{
    id: 2,
    name: "user",
}
```

**Tests attendus** :

- les rôles sont présents dans la BDD
- les utilisateurs possèdent chacun un rôle
- la route `/auth/me` renvoie aussi le rôle associé.

## Critères de validation

✅ La route GET `/auth/me` fonctionne uniquement si le token est présent et valide

✅ La réponse contient les infos de l'utilisateur ainsi que son rôle

✅ Un nouvel utilisateur a automatiquement le rôle user

✅ Le frontend affiche les bonnes informations de l'utilisateur connecté dans la navbar
